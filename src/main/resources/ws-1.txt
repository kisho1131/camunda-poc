disableSubmitCommentaryBtn(): boolean {
  const profiles = this.profileDetails ?? [];
  if (!profiles.length) return true;

  const statuses = profiles.map(p => p?.statusCd ?? null);

  // helpers
  const allEqual = (val: string) => statuses.every(s => s === val);
  const hasAny = (val: string | null) => statuses.includes(val);
  const hasInProgress = statuses.some(
    s => ['IN_PROGRESS', 'INPROGRESS'].includes(String(s))
  );

  // 1. Incomplete commentary
  if (this.profileStatus?.some(ps => ps.incomplete !== 0)) return true;

  // 2. All uniform states
  if (allEqual('APPROVED') || allEqual('REJECTED') || allEqual('COMPLETED')) return true;

  // 3. Pending (null)
  if (hasAny(null)) return true;

  // 4. Blocking combos
  if ((hasAny('REJECTED') && hasInProgress) ||
      (hasAny('COMPLETED') && hasInProgress)) return true;

  // 5. Enable when CREATED exists without blockers
  if (hasAny('CREATED') && !hasInProgress) return false;

  // 6. Default: disable
  return true;
}
